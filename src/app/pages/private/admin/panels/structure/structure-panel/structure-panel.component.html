<div class="structure-panel-container">

  <!-- üé® En-t√™te avec informations principales -->
  <section class="header-section">
    <div class="header-card">
      <mat-card class="structure-overview-card">
        <mat-card-content>
          <div class="structure-header">
            <!-- Logo/Avatar de la structure -->
            <div class="structure-avatar">
              @if (userStructureData?.logoUrl) {
                <img [src]="userStructureData!.logoUrl" [alt]="userStructureData!.name" class="structure-logo">
              } @else {
                <div class="structure-icon-placeholder">
                  <mat-icon>business</mat-icon>
                </div>
              }
            </div>

            <!-- Informations principales -->
            <div class="structure-info">
              <h1 class="structure-name">
                {{ userStructureData?.name || 'Ma Structure' }}
              </h1>
              <p class="structure-address">
                <mat-icon>location_on</mat-icon>
                {{ getFormattedAddress() }}
              </p>

              <!-- Statut de la structure -->
              <mat-chip
                [color]="statusConfig().color"
                class="status-chip">
                <mat-icon matChipAvatar>{{ statusConfig().icon }}</mat-icon>
                {{ statusConfig().label }}
              </mat-chip>
            </div>

            <!-- Actions rapides -->
            <div class="header-actions">
              <button
                mat-icon-button
                (click)="refreshData()"
                matTooltip="Actualiser les donn√©es"
                class="refresh-btn">
                <mat-icon>refresh</mat-icon>
              </button>

              <button
                mat-stroked-button
                color="primary"
                (click)="openPublicPage()"
                matTooltip="Voir la page publique">
                <mat-icon>visibility</mat-icon>
                Page publique
              </button>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </section>

  <!-- üìä Statistiques rapides -->
  <section class="stats-section">
    <div class="stats-grid">

      <!-- Stat: Zones -->
      <mat-card class="stat-card zones-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon zones-icon">
              <mat-icon>map</mat-icon>
            </div>
            <div class="stat-details">
              <div class="stat-number">{{ areaCount() }}</div>
              <div class="stat-label">Zone{{ areaCount() !== 1 ? 's' : '' }}</div>
            </div>
          </div>
          @if (areaCount() === 0) {
            <div class="stat-action">
              <button
                mat-stroked-button
                color="accent"
                size="small"
                (click)="navigateToAreas()">
                Cr√©er des zones
              </button>
            </div>
          }
        </mat-card-content>
      </mat-card>

      <!-- Stat: √âquipe -->
      <mat-card class="stat-card team-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon team-icon">
              <mat-icon>group</mat-icon>
            </div>
            <div class="stat-details">
              <div class="stat-number">{{ teamCount() }}</div>
              <div class="stat-label">Membre{{ teamCount() !== 1 ? 's' : '' }}</div>
            </div>
          </div>
          @if (teamCount() <= 1) {
            <div class="stat-action">
              <button
                mat-stroked-button
                color="primary"
                size="small"
                (click)="navigateToTeam()">
                Inviter des membres
              </button>
            </div>
          }
        </mat-card-content>
      </mat-card>

      <!-- Stat: √âv√©nements -->
      <mat-card class="stat-card events-card">
        <mat-card-content>
          <div class="stat-content">
            <div class="stat-icon events-icon">
              <mat-icon>event</mat-icon>
            </div>
            <div class="stat-details">
              <div class="stat-number">{{ eventCount() }}</div>
              <div class="stat-label">√âv√©nement{{ eventCount() !== 1 ? 's' : '' }}</div>
            </div>
          </div>
          <div class="stat-action">
            <button
              mat-stroked-button
              color="accent"
              size="small"
              (click)="navigateToEvents()">
              Voir tout
            </button>
          </div>
        </mat-card-content>
      </mat-card>

    </div>
  </section>

  <!-- üõ†Ô∏è Actions principales -->
  <section class="actions-section">
    <div class="actions-grid">

      <!-- Action: Informations -->
      <mat-card class="action-card info-card">
        <mat-card-header class="action-header">
          <div mat-card-avatar class="action-avatar info-avatar">
            <mat-icon>edit</mat-icon>
          </div>
          <mat-card-title>Informations</mat-card-title>
          <mat-card-subtitle>Modifier les d√©tails de votre structure</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p class="action-description">
            Mettez √† jour le nom, l'adresse, les contacts et les informations g√©n√©rales de votre structure.
          </p>
        </mat-card-content>
        <mat-card-actions>
          <button
            mat-flat-button
            color="primary"
            (click)="navigateToEdit()">
            <mat-icon>edit</mat-icon>
            Modifier
          </button>
        </mat-card-actions>
      </mat-card>

      <!-- Action: Gestion √©quipe -->
      <mat-card class="action-card team-card">
        <mat-card-header class="action-header">
          <div mat-card-avatar class="action-avatar team-avatar">
            <mat-icon>group</mat-icon>
          </div>
          <mat-card-title>√âquipe</mat-card-title>
          <mat-card-subtitle>G√©rer les membres et leurs r√¥les</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p class="action-description">
            Invitez de nouveaux membres, assignez des r√¥les et g√©rez les permissions d'acc√®s.
          </p>
        </mat-card-content>
        <mat-card-actions>
          <button
            mat-flat-button
            color="primary"
            (click)="navigateToTeam()">
            <mat-icon>settings</mat-icon>
            G√©rer l'√©quipe
          </button>
        </mat-card-actions>
      </mat-card>

      <!-- Action: Zones et espaces -->
      <mat-card class="action-card areas-card">
        <mat-card-header class="action-header">
          <div mat-card-avatar class="action-avatar areas-avatar">
            <mat-icon>map</mat-icon>
          </div>
          <mat-card-title>Zones & Espaces</mat-card-title>
          <mat-card-subtitle>Configurer les espaces physiques</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p class="action-description">
            D√©finissez les diff√©rentes zones de votre structure : sc√®nes, bars, gradins, etc.
          </p>
        </mat-card-content>
        <mat-card-actions>
          <button
            mat-flat-button
            color="accent"
            (click)="navigateToAreas()">
            <mat-icon>settings</mat-icon>
            Configurer les zones
          </button>
        </mat-card-actions>
      </mat-card>

      <!-- Action: √âv√©nements -->
      <mat-card class="action-card events-management-card">
        <mat-card-header class="action-header">
          <div mat-card-avatar class="action-avatar events-avatar">
            <mat-icon>event</mat-icon>
          </div>
          <mat-card-title>√âv√©nements</mat-card-title>
          <mat-card-subtitle>Cr√©er et g√©rer vos √©v√©nements</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <p class="action-description">
            Cr√©ez de nouveaux √©v√©nements, g√©rez les r√©servations et suivez les statistiques.
          </p>
        </mat-card-content>
        <mat-card-actions>
          <button
            mat-flat-button
            color="accent"
            (click)="navigateToEvents()">
            <mat-icon>add</mat-icon>
            G√©rer les √©v√©nements
          </button>
        </mat-card-actions>
      </mat-card>

    </div>
  </section>

  <!-- üîÑ √âtat de chargement -->
  @if (isLoadingStructure()) {
    <div class="loading-overlay">
      <mat-card class="loading-card">
        <mat-card-content>
          <div class="loading-content">
            <mat-progress-spinner mode="indeterminate" diameter="50"></mat-progress-spinner>
            <p>Chargement des informations de votre structure...</p>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  }

</div>

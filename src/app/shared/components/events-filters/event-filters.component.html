<div class="filter-bar" [formGroup]="filterForm">
  <!-- Champ de Recherche -->
  <mat-form-field appearance="outline" class="search-field">
    <mat-label>Rechercher</mat-label>
    <mat-icon matPrefix>search</mat-icon>
    <input matInput formControlName="searchTerm" placeholder="Nom, lieu, artiste...">
  </mat-form-field>

  <!-- Bouton Filtres Avancés -->
  <button mat-stroked-button (click)="toggleAdvancedFilters()" class="advanced-filters-button">
    <mat-icon>filter_list</mat-icon>
    Filtres
  </button>

  <!-- Filtres rapides par Catégorie -->
  <div class="category-chips-container">
    <mat-chip-listbox aria-label="Filtrer par catégorie" formControlName="category">
      <mat-chip-option *ngFor="let category of categories" [value]="category" (click)="selectCategory(category)">
        {{ category }}
      </mat-chip-option>
    </mat-chip-listbox>
  </div>


  <!-- Option de Tri -->
  <mat-form-field appearance="outline" class="sort-options">
    <mat-label>Trier par</mat-label>
    <mat-select formControlName="sortBy">
      <mat-option *ngFor="let sort of sortOptions" [value]="sort.value">
        {{ sort.viewValue }}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <!-- (Optionnel) Bouton pour tout réinitialiser -->
  <button mat-icon-button (click)="resetAllFilters()" matTooltip="Réinitialiser tous les filtres" class="reset-all-button">
    <mat-icon>refresh</mat-icon>
  </button>
</div>

<!-- Panneau de Filtres Avancés (exemple simple avec ngIf, un MatDrawer serait mieux) -->
<div *ngIf="showAdvancedFiltersPanel" class="advanced-filters-panel">
  <h4>Filtres Avancés</h4>

  <div [formGroup]="filterForm.get('dateRange')!" class="filter-section">
    <mat-form-field appearance="outline" class="date-range-field">
      <mat-label>Plage de dates</mat-label>
      <mat-date-range-input [rangePicker]="picker">
        <input matStartDate formControlName="start" placeholder="Date de début">
        <input matEndDate formControlName="end" placeholder="Date de fin">
      </mat-date-range-input>
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field>
    <div class="quick-date-options">
      <button mat-stroked-button (click)="selectDateQuickOption('today')">Aujourd'hui</button>
      <button mat-stroked-button (click)="selectDateQuickOption('weekend')">Ce week-end</button>
      <button mat-stroked-button (click)="selectDateQuickOption('next_week')">Semaine prochaine</button>
      <button mat-stroked-button (click)="selectDateQuickOption('next_month')">Mois prochain</button>
    </div>
  </div>

  <mat-form-field appearance="outline" class="filter-section">
    <mat-label>Lieu / Ville</mat-label>
    <input matInput formControlName="location" placeholder="Entrez une ville">
  </mat-form-field>

  <div *ngIf="availableGenres.length > 0" formArrayName="genres" class="filter-section genres-section">
    <label class="genres-label">Genres (pour {{ filterForm.get('category')?.value }}):</label>
    <div class="genres-checkboxes">
      <mat-checkbox *ngFor="let genre of availableGenres; let i = index"
                    [formControlName]="i"
                    (change)="onGenreChange($event, i)">
        {{ genre }}
      </mat-checkbox>
    </div>
  </div>

  <div class="advanced-filters-actions">
    <button mat-stroked-button (click)="resetAdvancedFilters()">Réinitialiser Avancés</button>
    <button mat-flat-button color="accent" (click)="applyAdvancedFilters()">Appliquer</button>
  </div>
</div>
